<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FinanceFlow ‚Äî Minimal Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* ====== Reset & Base ====== */
    *{box-sizing:border-box;margin:0;padding:0}
    :root{
      --bg:#f5f8fb;--card:#ffffff;--primary:#0077b6;--muted:#6c757d;--positive:#28a745;--negative:#dc3545
    }
    body{
      font-family:Inter, 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial;
      background:linear-gradient(180deg,var(--bg) 0%, #eef6fb 100%);
      min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px;
    }

    /* ====== Container ====== */
    .wrap{width:100%;max-width:1100px}
    .panel{background:var(--card);border-radius:20px;box-shadow:0 10px 30px rgba(2,40,80,0.06);padding:28px}

    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    header h1{font-size:1.4rem;color:var(--primary);font-weight:700;letter-spacing:-0.2px}
    header p{color:var(--muted);font-size:0.95rem}

    /* ====== Controls ====== */
    .controls{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px;margin:20px 0}
    .controls select,.controls input{padding:10px 12px;border-radius:10px;border:1px solid #e9eef6;background:#fff}
    .controls button{padding:10px 12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--primary),#005a8d);color:white;font-weight:600;cursor:pointer}
    .controls .danger{background:linear-gradient(90deg,#dc3545,#b52b2b)}

    /* ====== Stats Row ====== */
    .stats{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px}
    .stat{background:#fbfdff;border-radius:12px;padding:14px;border:1px solid #f1f5f9}
    .stat .label{font-size:0.75rem;color:var(--muted);text-transform:uppercase;font-weight:700;letter-spacing:0.6px}
    .stat .value{font-size:1.05rem;font-weight:800;margin-top:8px}
    .stat.positive .value{color:var(--positive)}
    .stat.negative .value{color:var(--negative)}

    /* ====== Layout ====== */
    .grid{display:grid;grid-template-columns:2fr 1.2fr;gap:18px}
    .card{background:var(--card);border-radius:14px;padding:18px;border:1px solid #f1f5f9;box-shadow:0 6px 18px rgba(2,40,80,0.03)}
    .card h2{font-size:1rem;margin-bottom:12px;color:#223}

    /* list transactions */
    ul{list-style:none;max-height:320px;overflow:auto}
    li{display:flex;justify-content:space-between;padding:10px 6px;border-radius:8px}
    li + li{margin-top:6px}
    .tx .meta{font-size:0.9rem;color:#334}
    .tx .amt{font-weight:700}
    .btn-del{background:transparent;border:1px solid #f1f1f1;padding:6px 8px;border-radius:8px;cursor:pointer}

    /* category breakdown */
    .breakdown{margin-top:12px}
    .category-item{display:flex;justify-content:space-between;padding:8px 0;border-top:1px solid #f3f6fb}
    .category-name{display:flex;gap:8px;align-items:center}
    .dot{width:10px;height:10px;border-radius:50%}

    /* small chart container */
    .small-chart{height:160px}

    /* responsive */
    @media (max-width:920px){.grid{grid-template-columns:1fr}.stats{grid-template-columns:1fr}}

    /* subtle animations */
    .fade{animation:fadeIn .45s ease both}
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel fade">
      <header>
        <div>
          <h1>üí∞ FinanceFlow</h1>
          <p>Dashboard minimalista ‚Äî distribu√≠do por categorias</p>
        </div>
      </header>

      <div class="controls">
        <select id="tipo">
          <option value="gasto">üí∏ Gasto</option>
          <option value="receita">üíµ Receita</option>
        </select>
        <select id="categoria">
          <option value="Abundar">Abundar</option>
          <option value="Doar">Doar</option>
          <option value="Investir">Investir</option>
          <option value="Educar">Educar</option>
          <option value="Desfrutar">Desfrutar</option>
          <option value="Conquistar">Conquistar</option>
          <option value="Sustentar">Sustentar</option>
          <option value="Bug">Bug</option>
        </select>
        <input id="descricao" placeholder="Descri√ß√£o" />
        <input id="valor" type="number" step="0.01" placeholder="Valor (R$)" />
        <button onclick="adicionar()">‚ûï Adicionar</button>
        <button class="danger" onclick="resetApp()">üóë Resetar</button>
      </div>

      <div class="stats">
        <div class="stat positive">
          <div class="label">Receitas</div>
          <div class="value" id="totalReceitas">R$ 0,00</div>
        </div>
        <div class="stat negative">
          <div class="label">Gastos</div>
          <div class="value" id="totalGastos">R$ 0,00</div>
        </div>
        <div class="stat">
          <div class="label">Economia</div>
          <div class="value" id="economia">0%</div>
        </div>
      </div>

      <div class="grid">
        <div class="card">
          <h2>üìä Distribui√ß√£o de Gastos</h2>
          <canvas id="grafico" style="max-height:420px"></canvas>
          <div class="breakdown" id="categoryBreakdown"></div>
        </div>

        <div class="card">
          <h2>üìù Transa√ß√µes</h2>
          <ul id="lista"></ul>
          <div style="margin-top:12px">
            <strong>Saldo: </strong> R$ <span id="saldo">0.00</span>
          </div>

          <hr style="margin:12px 0;border:none;border-top:1px solid #f3f6fb"/>

          <h2>üíº Sal√°rio</h2>
          <div style="display:flex;gap:8px;margin-bottom:10px">
            <input id="salario" placeholder="Sal√°rio mensal" type="number" step="0.01" />
            <button onclick="definirSalario()">Definir</button>
          </div>
          <div style="font-size:0.9rem;color:var(--muted)">Dispon√≠vel: R$ <strong id="salarioValor">0.00</strong></div>
          <div class="small-chart" style="margin-top:10px">
            <canvas id="graficoSalario"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ====== Dados iniciais ======
    let dados = {gastos:[],receitas:[],salario:0};

    const listaEl = document.getElementById('lista');
    const saldoEl = document.getElementById('saldo');
    const salarioValorEl = document.getElementById('salarioValor');

    // ====== Chart principal ======
    const ctx = document.getElementById('grafico').getContext('2d');
    const grafico = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['Abundar','Doar','Investir','Educar','Desfrutar','Conquistar','Sustentar','Bug','Sobra'],
        datasets:[{data:Array(9).fill(0),backgroundColor:['#264653','#2a9d8f','#e9c46a','#f4a261','#e76f51','#6a4c93','#0077b6','#90e0ef','#06d6a0'],borderColor:'#fff',borderWidth:3}]
      },
      options:{
        responsive:true,
        maintainAspectRatio:false,
        cutout:'70%', // mais minimalista
        animation:{animateRotate:true,animateScale:true,duration:600},
        plugins:{
          legend:{display:false}, // minimalista: legenda removida
          tooltip:{
            padding:10,cornerRadius:8,backgroundColor:'rgba(0,0,0,0.8)',
            callbacks:{label:function(ctx){const total = ctx.dataset.data.reduce((a,b)=>a+b,0);const val=ctx.raw||0;const pct= total?((val/total)*100).toFixed(1):0;return `${ctx.label}: R$ ${Number(val).toFixed(2)} (${pct}%)`}}
          }
        }
      }
    });

    // ====== Chart salario ======
    const ctxS = document.getElementById('graficoSalario').getContext('2d');
    const graficoSalario = new Chart(ctxS,{type:'doughnut',data:{labels:['Gastos','Receitas','Dispon√≠vel'],datasets:[{data:[0,0,0],backgroundColor:['#dc3545','#28a745','#0077b6'],borderColor:'#fff',borderWidth:3}]},options:{responsive:true,maintainAspectRatio:false,cutout:'65%',plugins:{legend:{position:'bottom',labels:{font:{size:11}}},tooltip:{callbacks:{label:function(ctx){const total=ctx.dataset.data.reduce((a,b)=>a+b,0);const val=ctx.raw||0;const pct= total?((val/total)*100).toFixed(1):0;return `${ctx.label}: R$ ${Number(val).toFixed(2)} (${pct}%)`}}}}});

    // ====== Fun√ß√µes ======
    function definirSalario(){
      const s = parseFloat(document.getElementById('salario').value);
      if(isNaN(s)||s<=0){alert('Digite um sal√°rio v√°lido');return}
      dados.salario = s;document.getElementById('salario').value='';atualizar();
    }

    function adicionar(){
      const tipo = document.getElementById('tipo').value;
      const categoria = document.getElementById('categoria').value;
      const descricao = document.getElementById('descricao').value.trim();
      const valor = parseFloat(document.getElementById('valor').value);
      if(!descricao||isNaN(valor)||valor<=0){alert('Preencha corretamente.');return}
      if(tipo==='gasto') dados.gastos.push({descricao,valor,categoria}); else dados.receitas.push({descricao,valor,categoria});
      document.getElementById('descricao').value='';document.getElementById('valor').value='';atualizar();
    }

    function atualizar(){
      // limpar lista
      listaEl.innerHTML='';
      let totalGastos=0,totalReceitas=0;
      const categorias = {Abundar:0,Doar:0,Investir:0,Educar:0,Desfrutar:0,Conquistar:0,Sustentar:0,Bug:0};

      dados.gastos.forEach((g,i)=>{totalGastos+=g.valor;categorias[g.categoria]+=g.valor;const li=document.createElement('li');li.className='fade';li.innerHTML=`<div class="tx"><div class="meta">üí∏ <strong>${g.categoria}</strong> ‚Äî ${g.descricao}</div></div><div><span class="amt">R$ ${g.valor.toFixed(2)}</span> <button class="btn-del" onclick="remover('gasto',${i})">X</button></div>`;listaEl.appendChild(li)});
      dados.receitas.forEach((r,i)=>{totalReceitas+=r.valor;const li=document.createElement('li');li.className='fade';li.innerHTML=`<div class="tx"><div class="meta">üíµ <strong>Receita</strong> ‚Äî ${r.descricao}</div></div><div><span class="amt">R$ ${r.valor.toFixed(2)}</span> <button class="btn-del" onclick="remover('receita',${i})">X</button></div>`;listaEl.appendChild(li)});

      if(dados.gastos.length===0 && dados.receitas.length===0){const emp=document.createElement('div');emp.style.padding='18px';emp.style.textAlign='center';emp.style.color='var(--muted)';emp.textContent='Nenhuma transa√ß√£o registrada';listaEl.appendChild(emp)}

      const saldo = totalReceitas - totalGastos;
      saldoEl.textContent = saldo.toFixed(2);
      saldoEl.style.color = saldo>=0? 'var(--positive)': 'var(--negative)';

      document.getElementById('totalReceitas').textContent = `R$ ${totalReceitas.toFixed(2)}`;
      document.getElementById('totalGastos').textContent = `R$ ${totalGastos.toFixed(2)}`;
      const economia = totalReceitas>0?((saldo/totalReceitas)*100):0;
      document.getElementById('economia').textContent = `${economia.toFixed(1)}%`;

      // dados gr√°fico principal ‚Äî mant√©m ordem das labels
      const values = Object.values(categorias);
      const sobra = saldo>0? saldo: 0;
      values.push(sobra);

      // evita divis√£o estranha: aqui mantemos valores reais (Chart.js mostra propor√ß√£o)
      grafico.data.datasets[0].data = values;
      grafico.update();

      // breakdown visual
      const cb = document.getElementById('categoryBreakdown');cb.innerHTML='';
      const colors = {Abundar:'#264653',Doar:'#2a9d8f',Investir:'#e9c46a',Educar:'#f4a261',Desfrutar:'#e76f51',Conquistar:'#6a4c93',Sustentar:'#0077b6',Bug:'#90e0ef'};
      Object.entries(categorias).forEach(([cat,val])=>{if(val>0){const d=document.createElement('div');d.className='category-item';d.innerHTML=`<div class="category-name"><span class="dot" style="background:${colors[cat]}"></span>${cat}</div><div>R$ ${val.toFixed(2)}</div>`;cb.appendChild(d)}});

      // atualizar gr√°fico de sal√°rio
      const disponivel = Math.max(0, dados.salario - totalGastos + totalReceitas);
      graficoSalario.data.datasets[0].data = [totalGastos, totalReceitas, disponivel];
      graficoSalario.update();

      salarioValorEl.textContent = dados.salario.toFixed(2);
    }

    function remover(tipo,index){if(confirm('Deseja realmente apagar este item?')){dados[tipo==='gasto'?'gastos':'receitas'].splice(index,1);atualizar()}}
    function resetApp(){if(confirm('Resetar todos os dados?')){dados={gastos:[],receitas:[],salario:0};atualizar()}}

    // iniciar
    atualizar();

  </script>
</body>
</html>
